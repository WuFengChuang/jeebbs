<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>${topic.title!}</title>
<meta name="keywords" content="java,cms,jsp,cms,jsp bbs,开源网站内容管理系统,网站群,站群,多站点,jeecms" />
<meta name="description" content="讨论jsp cms、jsp bbs相关资讯，struts,hibernate,spring,freemarker最新技术研究" /> 
<meta property="qc:admins" content="26435257006110776654" />
<script src="${resSys}/jquery.js" type="text/javascript"></script>
<script src="${resSys}/front.js" type="text/javascript"></script>
    <script src="/${res}/bbs_forum/js/pony.js" type="text/javascript"></script>
    <script src="/${res}/bbs_forum/js/PnEditor.js" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="/${res}/bbs_forum/css/whole.css" />
     <script type="text/javascript">
function checkContent(){
  if($("#_editor_textarea").val()==""){
     alert("内容不能为空");
     return false;
  }
  return true;
}
</script>
<link rel="stylesheet" type="text/css" href="/${res}/bbs_forum/css/base.css" />
<style>
#_editor_controls{text-align:left;}
#_editor_controls ._menu{font-size:12px;padding:0 10px;}

._controls_normal{border:1px solid #F5F5F0;}
._controls_hover{border:1px solid #9DB3C5;background-color:#E8F3FD;}

#_pop_container{font-size:12px;}
#_pop_container ul{list-style-type:none;margin:0px;padding:10px 7px;}
#_pop_container li{padding:1px;cursor:pointer}
#_pop_container > div{position:absolute;border:1px solid #CCC;border-bottom-style:solid;background-color:#FFF}

#_forecolor_pop{padding:5px;}
#_forecolor_pop td{width:12px;height:12px;}
#_forecolor_pop td div{width:10px;height:10px;cursor:pointer;}
._forecolor_normal{border:1px solid #FFF;}
._forecolor_hover{border:1px solid #000;}

._center{text-align:center;}
._pop_input{width:270px;padding:10px 10px;}
._pop_input input[type=text]{width:260px;}
._pop_input div{padding:1px 0;}
._pop_input hr{height:1px;padding-top:0px; margin-top:0px;}

._editor_local_img{border:1px solid #CCC;padding:10px;background-color:#FFF}
#smile{overflow:hidden;}
#smile img{cursor:pointer;}

.ftwidth{width:100%;}
.edit-topic-body .topic-area{height:192px;}
.editortoolbar{margin-bottom:10px;}
.editortoolbar a{margin-right:10px; font-size:12px; height:24px; line-height:24px; display:inline-block; float:left; cursor:pointer; text-decoration:none;}
.editortoolbar a:hover{border:1px solid #C1C1C1;}
.ft-box{border:1px solid #f0f0f0; margin-top:24px;}
.edit-topic-body .ft-select{width:170px; border-radius: 4px;border: 1px solid #dde7ed;padding-left: 16px;font-size: 14px;height: 44px;line-height: 44px;margin-bottom: 20px;}

#_file_container_more{margin-top:20px; font-size:12px;}
#_file_container_more a{font-size:12px;}
._pop_input input[type=text]{border:1px solid #999; width:100%; border-radius:3px; height:24px; text-indent:6px;}
._pop_input ._center{margin-top:6px; text-align:right;}
._pop_input #_email_ok, ._pop_input #_image_ok, ._pop_input #_link_ok{padding:3px 6px; background:#188ae2; border-radius:3px; color:#fff; font-size:12px; cursor:pointer;}
._pop_input ._input_cancel{padding:3px 6px; background:#999; border-radius:3px; color:#fff; font-size:12px; cursor:pointer;}

.topic-area{width: 100%;border-radius: 4px;border: 1px solid #dde7ed;padding-left: 16px;padding-top: 12px;font-size: 14px;}
</style>
</head>

	<body>
		<!--include-header-->
		[#include "../include/页头.html"/]
		<!--论坛信息-->
		[#include "../include/论坛信息.html"/]
		<!--main-->
		<div class="bbs-main clearfix">
			<!--左侧 include-->
			[#include "../include/左侧.html"/]
			<!--右侧内容-->
			<div class="right-main right-panel clearfix">
				<!--帖子类型切换-->
				<div class="main-header clearfix">
				  <!--左侧通用-->
				  <div class="channl-name">
					<img src="/${res}/bbs_forum/images/icon-find.png" alt="" />
					<span>${topic.title!}</span>
				  </div>
				  <!--右侧切换内容-->
				  <div class="right-tab">
					<div class="zt-select">
						<span>全部主题</span>
						<i class="iconfont icon-xiajiantou"></i>
					</div>
				  </div>
				</div>
				<!--详情贴-->
				<ul class="bbs-content-card">
					<!--楼主贴-->
					<li class="first-floor">
						<!--用户信息-->
						<div class="user-header clearfix">
							<img src="${topic.creater.avatar!'/${res}/bbs_member/img/face/none.gif'}" class="user-img" />
							<div class="user-info">
								<p>
									<span class="user-name">[#if topic.firstPost.anonymous]匿名[#else]${topic.firstPost.creater.username!}[/#if]</span>
									 <img src="${topic.firstPost.creater.group.imgPath!}" class="level"/>
								</p>
								<p class="time-box">
									<span>${topic.createTimeHtml!}</span>
									<span></span>
								</p>
							</div>
							<div class="friend-bar">
							   <!--通讯录-->
								[#if user??&&user.id!=topic.creater.id]
								[#if !user.myFriendIds?seq_contains('${topic.creater.id}')]
								<a id="u${topic.creater.id}_${topic.id}" onclick="apply('${topic.creater.id}','${topic.creater.username}','${topic.id}')"  class="iconfont  icon-tongxunlu1 green" title="添加好友"></a>
								[#else]
								<a id="u${topic.creater.id}_${topic.id}" onclick="applyDel('${topic.creater.id}','${topic.creater.id}','${topic.id}')"  class="iconfont  icon-tongxunlu green" title="取消好友"></a>
								[/#if]
								[/#if]
								
								
								
								
								<!--关注-->
								[#if user??&&user.id!=topic.creater.id]
								[#if !user.myAttentionIds?seq_contains('${topic.creater.id}')]
								<a id="a${topic.creater.id}_${topic.id}" onclick="attent('${topic.creater.id}',0)" class="iconfont icon-guanzhu yellow" title="添加关注"></a>
								[#else]
								<a id="a${topic.creater.id}_${topic.id}" onclick="attent('${topic.creater.id}',1)" class="iconfont icon-yiguanzhu yellow" title="取消关注"></a>
								[/#if]
								[/#if]
							</div>
							<!--楼层操作-->
							<div class="floor-info">
								<p class="floor-num">1#</p>
								<p class="floor-opts">
									[#if user??]
									[#if user.moderator&&!topic.creater.moderator]
										<a id="forbiddenLink_${topic.creater.id}_${topic.firstPost.id}" onclick="forBidden('${topic.creater.id}','${topic.forum.id}')"  title="禁用">
										[#if topic.creater.disabled]解除禁用[#else]禁用[/#if]
										</a>
									[/#if]
									[/#if]
									[#if createrId??]
									<a href="${topic.url}">显示全部</a>
									[#else]
									<a href="${base}/topic/postListByAuthor.jspx?topicId=${topic.id}&createrId=${topic.firstPost.creater.id}">只看该作者</a>
									[/#if]
								</p>
							</div>
						</div>
						[#if topic.types??&&topic.types?size gt 0]
						<div class="form-topic">
							<span>来自话题:</span>
							[#list topic.types as t]
							[#if t_index<3]
							<span class="topic"><a href="${t.url!}">${t.name!}</a></span>
							[/#if]
							[/#list]
						</div>
						[/#if]
						<h2 class="theme-tit"><a href="${topic.url}">[@text_cut s=topic.title?html /]</a></h2>
						<ul class="theme-pics clearfix">
							[#if topic.affix]
							[#list topic.firstPost.attachments as t]
								[#if t.picture]
									<li><img src="${t.zoomPicPath!}" width="218" height="143" /></li>
								[/#if]
							[/#list]
							[/#if]
						</ul>
						<!--正文-->
						 [#if topic.firstPost.shield]
							  [#if user??&&user.moderator]
							  该贴已经被屏蔽，仅版主可见<p class="theme-desc">${topic.firstPost.contentHtml!}</p>
							  [#else]
							  该帖子已被屏蔽，仅版主可见
							  [/#if]
						  [#else]
							  [#if topic.firstPost.hidden]
								  [#if user??]
									  [#if topic.firstPost.creater.id==user.id||user.moderator]
										<p class="theme-desc">${topic.firstPost.contentHtml}</p>
									  [#else]
										  [#if !topic.haveReply?contains(','+user.id+',')]
											<p class="theme-desc">${topic.firstPost.hideContent}</p>
										  [#else]
											<p class="theme-desc">${topic.firstPost.contentHtml}</p>
										  [/#if]
									  [/#if]
								  [#else]
									 <p class="theme-desc">${topic.firstPost.hideContent}</p>
								  [/#if]
							  [#else]
							  <p class="theme-desc">${topic.firstPost.contentHtml}</p>
							  [/#if]
						  [/#if]
						<div class="theme-bottom-bar clearfix">
							<!--赞回复-->
							<div class="theme-operation">
								[#if user??] 
								<span id="uptopic${topic.id}" onclick="topicOp('${topic.id}',0)" class="operation-btn on" title="赞"><i class="icon-zan"></i>
									<span id="upcount${topic.id}">${topic.ups!}</span>
								</span>
								<span id="cuptopic${topic.id}" onclick="topicOp('${topic.id}',3)" class="operation-btn" title="赞" ><i class="icon-zan"></i>
									<span id="cupcount${topic.id}">${topic.ups!}</span>
								</span>
								<script type="text/javascript">
								[#if user??&&user.upTopicIds??&&user.upTopicIds?seq_contains("${topic.id}")]
									$("#uptopic${topic.id}").hide();
									$("#cuptopic${topic.id}").show();
								[#else]
									$("#uptopic${topic.id}").show();
									$("#cuptopic${topic.id}").hide();
								[/#if]
								</script>
								[/#if]
								<a id="replyMore${topic.id}" class="operation-btn" title="回复数"><i class="icon-mes"></i>
									<span>${topic.replyCount!}</span>
								</a>
								<span class="views">${topic.viewCount!}次浏览</span>
							</div>
							<!--分享等-->
							<!--操作等-->
							<div class="theme-operation">
								[#if user??]
								  [#if user.moderator||user.id==topic.creater.id]
									<a href="${base}/post/v_edit${topic.firstPost.id!}.jspx" class="hover-blue" title="编辑">
										<span>编辑</span>
									</a>
								  [/#if]
									<a href="${base}/post/v_quote${topic.firstPost.id!}.jspx" class="hover-blue" title="引用">
										<span>引用</span>
									</a>
									<a  onclick="report('${topic.wholeUrl!}')" class="hover-blue" title="举报">
										<span>举报</span>
									</a>
								  [#if user.moderator]
									  [#if !topic.firstPost.shield]
									  <a href="${base}/post/v_shield${topic.firstPost.id!}_${-1}.jspx" class="hover-blue" title="屏蔽">
										<span>屏蔽</span>
									  </a>
									  [#else]
									   <a href="${base}/post/v_shield${topic.firstPost.id!}_${0}.jspx" class="hover-blue" title="取消屏蔽">
										<span>取消屏蔽</span>
									  </a>
									  [/#if]
									  <a id="topLevel${topic.id}" onclick="upTopLevel('${topic.id}','${topic.forum.id}')"  class="hover-blue" [#if topic.topLevel lte 0]title="置顶"[#else]取消置顶[/#if] >
										<span>[#if topic.topLevel lte 0]置顶[#else]取消置顶[/#if]</span>
									  </a>
								  [/#if]
								  [#if user.moderator||user.id==topic.creater.id]
									<a href="${base}/topic/o_delete.jspx?topicIds=${topic.id!}" class="hover-blue" title="删除">
										<span>删除</span>
									</a>
								  [/#if]
								[/#if]
							</div>
							<!--关注-->
							[#if user??]
								<a href="#attenttopic${topic.id}" class="add-atten" id="attenttopic${topic.id}" onclick="topicOp('${topic.id}',2)">+ 关注帖子</a>
								<a href="#cattenttopic${topic.id}" class="close-atten"  id="cattenttopic${topic.id}" onclick="topicOp('${topic.id}',5)">- 取消关注</a>
								<script type="text/javascript">
								[#if user??&&user.attentTopicIds??&&user.attentTopicIds?seq_contains("${topic.id}")]
									$("#attenttopic${topic.id}").hide();
									$("#cattenttopic${topic.id}").show();
								[#else]
									$("#attenttopic${topic.id}").show();
									$("#cattenttopic${topic.id}").hide();
								[/#if]
								</script>
							[/#if] 
						</div>
					</li>
					<!--回复列表-->
					[@post_page topicId=topic.id createrId=createrId orderBy=orderBy count='2' option='2']
					[#list tag_pagination.list as post]
					<!--非题主帖子-->
					[#if !post.first]
					<li>
						<div class="user-header clearfix">
							<img src="${post.creater.avatar!'/${res}/bbs_member/img/face/none.gif'}" class="user-img" />
							<div class="user-info ask-info">
								<p>
									<span class="user-name ask-user">[#if post.anonymous]匿名[#else]${post.creater.username!}[/#if]</span>
									<img src="${post.creater.group.imgPath!}" class="level"/>
								</p>
							</div>
							<div class="time-box ask-time">
								<span>${post.createTimeHtml!}</span>
							</div>
							<div class="friend-bar ask-friend">
								 <!--通讯录-->
								[#if user??&&user.id!=post.creater.id]
								[#if !user.myFriendIds?seq_contains('${post.creater.id}')]
								<a id="u${post.creater.id}_${post.id}" onclick="apply('${post.creater.id}','${post.creater.username}','${post.id}')"  class="iconfont  icon-tongxunlu1 green" title="添加好友"></a>
								[#else]
								<a id="u${post.creater.id}_${post.id}" onclick="applyDel('${post.creater.id}','${post.creater.id}','${post.id}')"  class="iconfont  icon-tongxunlu green" title="取消好友"></a>
								[/#if]
								[/#if]
								
								<!--关注-->
								[#if user??&&user.id!=post.creater.id]
								[#if !user.myAttentionIds?seq_contains('${post.creater.id}')]
								<a id="a${post.creater.id}_${post.id}" onclick="attent('${post.creater.id}',0)" class="iconfont icon-guanzhu yellow" title="添加关注"></a>
								[#else]
								<a id="a${post.creater.id}_${post.id}" onclick="attent('${post.creater.id}',1)" class="iconfont icon-yiguanzhu yellow" title="取消关注"></a>
								[/#if]
								[/#if]
                        
							</div>
							<div class="floor-info">
								<p class="floor-num">${post.indexCount}#</p>
							</div>
						</div>
						<p class="theme-desc">
							<!--正文-->
							 [#if post.shield]
							  [#if user??&&user.moderator]
							  该贴已经被屏蔽，仅版主可见<p class="theme-desc">${post.contentHtml!}</p>
							  [#else]
							  该帖子已被屏蔽，仅版主可见
							  [/#if]
							  [#else]
							  [#if post.hidden]
							  [#if user??]
							  [#if post.creater.id==user.id||user.moderator]
							  <p class="theme-desc">${post.contentHtml}</p>
							  [#else]
							  [#if !post.topic.haveReply?contains(','+user.id+',')]
							  <p class="theme-desc">${post.hideContent}</p>
							  [#else]
							  <p class="theme-desc">${post.contentHtml}</p>
							  [/#if]
							  [/#if]
							  [#else]
							  <p class="theme-desc">${post.hideContent}</p>
							  [/#if]
							  [#else]
							  <p class="theme-desc">${post.contentHtml}</p>
							  [/#if]
							 [/#if]
						</p>
						<div class="theme-bottom-bar clearfix">
							<div class="theme-operation">
								<a class="operation-btn" title="赞" id="uppost${post.id}" onclick="postUp('${post.id}',0)"><i class="icon-zan"></i>
									<span id="pupcount${post.id}">${post.ups!}</span>
								</a>
								<a class="operation-btn" title="赞" id="cuppost${post.id}" onclick="postUp('${post.id}',3)"><i class="icon-zan"></i>
									<span id="cuppost${post.id}">${post.ups!}</span>
								</a>
								<script type="text/javascript">
								[#if user??&&user.upPostIds?seq_contains('${post.id}')]
									$("#uppost${post.id}").hide();
									$("#cuppost${post.id}").show();
								[#else]
									$("#uppost${post.id}").show();
									$("#cuppost${post.id}").hide();
								[/#if]
								</script>
								<a  id="replyMore${post.id}" onclick="getPostChildPage(${post.id})" class="operation-btn" title="回复数"><i class="icon-mes"></i>
									<span>${post.replys!}</span>
								</a>
							</div>
							<!--操作等-->
							<div class="theme-operation">
								[#if user??]
								  [#if user.moderator||user.id==post.creater.id]
									<a href="${base}/post/v_edit${post.id!}.jspx" class="hover-blue" title="编辑">
										<span>编辑</span>
									</a>
								  [/#if]
									<a href="${base}/post/v_quote${post.id!}.jspx" class="hover-blue" title="引用">
										<span>引用</span>
									</a>
									<a  onclick="report('${post.wholeUrl!}')" class="hover-blue" title="举报">
										<span>举报</span>
									</a>
								  [#if user.moderator]
									  [#if !post.shield]
									  <a href="${base}/post/v_shield${post.id!}_${-1}.jspx" class="hover-blue" title="屏蔽">
										<span>屏蔽</span>
									  </a>
									  [#else]
									   <a href="${base}/post/v_shield${post.id!}_${0}.jspx" class="hover-blue" title="取消屏蔽">
										<span>取消屏蔽</span>
									  </a>
									  [/#if]
								  [/#if]
								  [#if user.moderator||user.id==post.creater.id]
									<a href="${base}/post/o_delete.jspx?ids=${post.id!}" class="hover-blue" title="删除">
										<span>删除</span>
									</a>
								  [/#if]
								[/#if]
							</div>
							<!--关注-->
							<div class="floor-info">
								<p class="floor-opts">
									[#if user??]
									[#if user.moderator&&!post.creater.moderator]
										<a id="forbiddenLink_${post.creater.id}_${post.id}" onclick="forBidden('${post.creater.id}','${topic.forum.id}')"  title="禁用">
										[#if post.creater.disabled]解除禁用[#else]禁用[/#if]
										</a>
									[/#if]
									[/#if]
									[#if createrId??]
									<a href="${topic.url}">显示全部</a>
									[#else]
									<a href="${base}/topic/postListByAuthor.jspx?topicId=${topic.id}&createrId=${post.creater.id}">只看该作者</a>
									[/#if]
								</p>
							</div>
						</div>
						 <!--回复区域-->
						<div id="postChildPage${post.id}"></div>
					</li>
					[/#if]
					[/#list]
					<div id="topicTable"></div>
					<div id="topicposts" style="display: none;"> </div>
				</ul>
				<script type="text/javascript">
				var totalPage="${tag_pagination.totalPage!}";
				var pageNo=2;
				var count=5;
					function getContent(){
						if(pageNo<=totalPage){
							$("#topicposts").load("${base}/topic/getPostList.jspx",
						{pageNo: pageNo,topicId:"${topic.id}",option:2}, 
						function(){
							$("#topicTable").append($("#topicposts").html());
							pageNo++;
							});
						}else{
							$("#topicTable").append("");
							$("#moreSpan").prop("disabled","disabled");
							$("#moreSpan").html("暂无更多");
						}
				}
				</script>  
				<a onclick="getContent()" id="moreSpan" [#if tag_pagination.totalPage<=1]disabled="disabled"[/#if] class="more-ask" >更多回复</a>
				[/@post_page]
				<!--回复区-->
				<div class="reply-box">
					[#if topic.allayReply]	
					[#if user??]
					<form id="jvForm" action="${base}/post/o_save.jspx" method="post" enctype="multipart/form-data" onsubmit="return checkContent();">
						<div class="reply-top clearfix">
							<div class="pull-left reply-read"><img src="/${res}/bbs_forum/images/icon-read.png"/>写下你的回复</div>
							<div class="pull-right size-chart"></div>
						</div>
                                       <div class="editortoolbar" id="_editor_controls"><a id="_bold_cmd" title="粗体" onclick="PnEditor.bbstyle('[b]','[/b]');"><img alt="" src="/${res}/bbs_forum/img/btn/bold.gif" /> </a><a id="_italic_cmd" title="斜体" onclick="PnEditor.bbstyle('[i]','[/i]');"><img alt="" src="/${res}/bbs_forum/img/btn/italic.gif" /> </a><a id="_underline_cmd" title="下划线" onclick="PnEditor.bbstyle('[u]','[/u]');"><img alt="" src="/${res}/bbs_forum/img/btn/underline.gif" /> </a><a class="_menu" id="_fontname_menu" title="字体" unselectable="on"><span id="posteditor_font_out">字体</span> </a><a class="_menu" id="_fontsize_menu" title="大小" unselectable="on">大小</a> <a class="_menu" id="_forecolor_menu" title="颜色" unselectable="on">颜色</a> <a id="_justifyleft_cmd" title="居左" onclick="PnEditor.bbstyle('[align=left]','[/align]');"><img alt="" src="/${res}/bbs_forum/img/btn/left.gif" /> </a><a id="_justifycenter_cmd" title="居中" onclick="PnEditor.bbstyle('[align=center]','[/align]');"><img alt="" src="/${res}/bbs_forum/img/btn/center.gif" /> </a><a id="_justifyright_cmd" title="居右" onclick="PnEditor.bbstyle('[align=right]','[/align]');"><img alt="" src="/${res}/bbs_forum/img/btn/right.gif" /> </a><a id="_link_menu" title="插入链接"><img alt="" src="/${res}/bbs_forum/img/btn/url.gif" /> </a><a id="_email_menu" title="插入邮箱链接"><img alt="" src="/${res}/bbs_forum/img/btn/email.gif" /> </a><a id="_image_menu" title="插入图片"><img alt="" src="/${res}/bbs_forum/img/btn/image.gif" /> </a><a id="_quote_cmd" title="插入引用" onclick="PnEditor.bbstyle('[quote]','[/quote]');"><img alt="" src="/${res}/bbs_forum/img/btn/quote.gif" /> </a><a id="_code_cmd" title="插入代码" onclick="PnEditor.bbstyle('[code]','[/code]');"><img alt="" src="/${res}/bbs_forum/img/btn/code.gif" /> </a><a id="_orderedlist_cmd" title="排序的列表" onclick="PnEditor.bbstyle('[list=1]\n','\n[/list]','[*]');"><img alt="" src="/${res}/bbs_forum/img/btn/orderedlist.gif" /> </a><a id="_unorderedlist_cmd" title="未排序列表" onclick="PnEditor.bbstyle('[list]\n','\n[/list]','[*]');"><img alt="" src="/${res}/bbs_forum/img/btn/unorderedlist.gif" /> </a><a id="_indent_cmd" title="增加缩进" onclick="PnEditor.bbstyle('[indent]','[/indent]');"><img alt="" src="/${res}/bbs_forum/img/btn/indent.gif" /> </a><a id="_floatleft_cmd" title="左浮动" onclick="PnEditor.bbstyle('[float=left]','[/float]');"><img alt="" src="/${res}/bbs_forum/img/btn/floatleft.gif" /> </a><a id="_floatright_cmd" title="右浮动" onclick="PnEditor.bbstyle('[float=right]','[/float]');"><img alt="" src="/${res}/bbs_forum/img/btn/floatright.gif" /> </a><a id="_hide_cmd" title="隐藏" onclick="PnEditor.bbstyle('[hide]','[/hide]');"><img alt="" src="/${res}/bbs_forum/img/btn/hide.gif" /> </a>
                                       <div style="clear: both"></div>
            </div>
            <div><textarea  rows="8" class="topic-area" vld="{rangelength:[2,4096]}" placeholder="内容" name="content" id="_editor_textarea_more"></textarea></div>
		<div id="_file_container"></div>
						
						
						<!--附件-->
						<div id="_file_container_more"></div>
						<div class="upload-box">
							<div id="_file_selecter_more">插入图片或附件：
							<input id="_editor_file_more" type="file" onchange="PnEditor.selectFileMore();" name="allattachments" />
							</div>
						</div>
						<input type="hidden" name="topicId" value="${topic.id}" />
						<input class="btn-primary pull-right" type="submit" name="Submit" value="回复" />
						
					</form>
					[/#if]
					[/#if]
				</div>
                                <div id="_pop_container">
    <div class="popupmenu_popup fontname_menu" id="_fontname_pop" style="display: none">
    <ul unselectable="on">
      <li unselectable="on">仿宋_GB2312</li>
      <li unselectable="on">黑体</li>
      <li unselectable="on">楷体_GB2312</li>
      <li unselectable="on">宋体</li>
      <li unselectable="on">新宋体</li>
      <li unselectable="on">微软雅黑</li>
      <li unselectable="on">Trebuchet MS</li>
      <li unselectable="on">Tahoma</li>
      <li unselectable="on">Arial</li>
      <li unselectable="on">Impact</li>
      <li unselectable="on">Verdana</li>
      <li unselectable="on">Times New Roman</li>
    </ul>
    </div>
    <div id="_fontsize_pop" style="display: none">
    <ul unselectable="on">
      <li unselectable="on" fontsize="10">较小</li>
      <li unselectable="on" fontsize="18">较大</li>
      <li unselectable="on" fontsize="6">极细字</li>
      <li unselectable="on" fontsize="8">细字</li>
      <li unselectable="on" fontsize="10">小字体</li>
      <li unselectable="on" fontsize="14">中字体</li>
      <li unselectable="on" fontsize="20">大字体</li>
      <li unselectable="on" fontsize="25">加大字</li>
      <li unselectable="on" fontsize="100">特大字</li>
    </ul>
    </div>
    <div id="_forecolor_pop" style="display: none">
    <table cellspacing="4" cellpadding="0" border="0">
      <tbody>
        <tr>
          <td col="Black">
          <div unselectable="on"></div>
          </td>
          <td col="Sienna">
          <div unselectable="on"></div>
          </td>
          <td col="DarkOliveGreen">
          <div unselectable="on"></div>
          </td>
          <td col="DarkGreen">
          <div unselectable="on"></div>
          </td>
          <td col="DarkSlateBlue">
          <div unselectable="on"></div>
          </td>
          <td col="Navy">
          <div unselectable="on"></div>
          </td>
          <td col="Indigo">
          <div unselectable="on"></div>
          </td>
          <td col="DarkSlateGray">
          <div unselectable="on"></div>
          </td>
        </tr>
        <tr>
          <td col="DarkRed">
          <div unselectable="on"></div>
          </td>
          <td col="DarkOrange">
          <div unselectable="on"></div>
          </td>
          <td col="Olive">
          <div unselectable="on"></div>
          </td>
          <td col="Green">
          <div unselectable="on"></div>
          </td>
          <td col="Teal">
          <div unselectable="on"></div>
          </td>
          <td col="Blue">
          <div unselectable="on"></div>
          </td>
          <td col="SlateGray">
          <div unselectable="on"></div>
          </td>
          <td col="DimGray">
          <div unselectable="on"></div>
          </td>
        </tr>
        <tr>
          <td col="Red">
          <div unselectable="on"></div>
          </td>
          <td col="SandyBrown">
          <div unselectable="on"></div>
          </td>
          <td col="YellowGreen">
          <div unselectable="on"></div>
          </td>
          <td col="SeaGreen">
          <div unselectable="on"></div>
          </td>
          <td col="MediumTurquoise">
          <div unselectable="on"></div>
          </td>
          <td col="RoyalBlue">
          <div unselectable="on"></div>
          </td>
          <td col="Purple">
          <div unselectable="on"></div>
          </td>
          <td col="Gray">
          <div unselectable="on"></div>
          </td>
        </tr>
        <tr>
          <td col="Magenta">
          <div unselectable="on"></div>
          </td>
          <td col="Orange">
          <div unselectable="on"></div>
          </td>
          <td col="Yellow">
          <div unselectable="on"></div>
          </td>
          <td col="Lime">
          <div unselectable="on"></div>
          </td>
          <td col="Cyan">
          <div unselectable="on"></div>
          </td>
          <td col="DeepSkyBlue">
          <div unselectable="on"></div>
          </td>
          <td col="DarkOrchid">
          <div unselectable="on"></div>
          </td>
          <td col="Silver">
          <div unselectable="on"></div>
          </td>
        </tr>
        <tr>
          <td col="Pink">
          <div unselectable="on"></div>
          </td>
          <td col="Wheat">
          <div unselectable="on"></div>
          </td>
          <td col="LemonChiffon">
          <div unselectable="on"></div>
          </td>
          <td col="PaleGreen">
          <div unselectable="on"></div>
          </td>
          <td col="PaleTurquoise">
          <div unselectable="on"></div>
          </td>
          <td col="LightBlue">
          <div unselectable="on"></div>
          </td>
          <td col="Plum">
          <div unselectable="on"></div>
          </td>
          <td col="White">
          <div unselectable="on"></div>
          </td>
        </tr>
      </tbody>
    </table>
    </div>
    <div class="_pop_input" id="_link_pop" style="display: none">
    <div><label for="_link_url">链接地址：</label></div>
    <div><input id="_link_url" type="text" /></div>
    <div><label for="_link_label">链接标题：</label></div>
    <div><input id="_link_label" type="text" /></div>
    <div class="_center"><input id="_link_ok" type="button" onclick="PnEditor.insertUrl($('#_link_url').val(),$('#_link_label').val(),'link');$('#_link_pop').hide();$('#_link_url').val('');$('#_link_label').val('');" value="确定" /> <input class="_input_cancel" type="button" value="取消" /></div>
    </div>
    <div class="_pop_input" id="_email_pop" style="display: none">
    <div><label for="_email_url">邮箱地址：</label></div>
    <div><input id="_email_url" type="text" /></div>
    <div class="_center"><input id="_email_ok" type="button" onclick="PnEditor.insertUrl($('#_email_url').val(),null,'email');$('#_email_pop').hide();$('#_email_url').val('');" value="确定" /> <input class="_input_cancel" type="button" value="取消" /></div>
    </div>
    <div class="_pop_input" id="_image_pop" style="display: none">
    <div><label for="_image_url">图片地址：</label></div>
    <div><input id="_image_url" type="text" /></div>
    <div class="_center"><input id="_image_ok" type="button" onclick="PnEditor.insertUrl($('#_image_url').val(),null,'img');$('#_image_pop').hide();$('#_image_url').val('');" value="确定" /> <input class="_input_cancel" type="button" value="取消" /></div>
    </div>
    </div>
			</div>
		</div>
		<!--footer-->
		[#include "../include/页脚.html"/]
		<script type="text/javascript">
			function displayPostReplayDive(postId){
				$("#innerPost"+postId).toggle();
			}
			function cancelContent(postId){
				$("#postReplyContent"+postId).val("");
			}
			function cancelTopicContent(topicId){
				$("#topicReplyContent"+topicId).val("");
			}
			function cancelPostContent(postId){
				$("#postChildReplyContent"+postId).val("");
			}
			
			//回复首页的帖子
			function replyPostContent(postId){
				$.post("${base}/post/o_saveAjax.jspx",{
					"content": $("#postReplyContent"+postId).val(),
					"topicId":"${topicId!}",
					"parentId":postId
				},function(data){
					if(data.status==1){
						getTopicPostInner("${topicId!}",1);
					}else if(data.status==-2){
                                                showModel('#noPerm');
                                        }
				});
			}
			//回复帖子详细页的帖子
			function replyPostChildContent(postId){
				$.post("${base}/post/o_saveAjax.jspx",{
					"content": $("#postChildReplyContent"+postId).val(),
					"topicId":"${topic.id!}",
					"parentId":postId
				},function(data){
					if(data.status==1){
						getPostChildInner(postId,1);
					}else if(data.status==-2){
                                           showModel('#noPerm');
                                        }              
				});
			}
			//回复主题
			function replyTopicContent(topicId){
				$.post("${base}/post/o_saveAjax.jspx",{
					"content": $("#topicReplyContent"+topicId).val(),
					"topicId":"${topicId!}"
				},function(data){
					if(data.status==1){
						getTopicPostInner("${topicId!}",1);
					}else if(data.status==-2){
                                                showModel('#noPerm');
                                        }
				});
			}
			function getPostChildPage(postId){
				var h=$("#postChildPage"+postId).html();
				if(h!=""){
					clearPostChildPage(postId);
				}else{
					$("#postChildPage"+postId).load("${base}/post/listChild.jspx?orderBy=1&parentId="+postId);
				}
			}
			function clearPostChildPage(postId){
				$("#postChildPage"+postId).html("");
			}
			/**
			 * 帖子点赞 0点赞 3取消点赞 
			 */
			function postUp(postId, operate) {
				$.post("${base}/post/up.jspx", {
					"postId" : postId,
					"operate" : operate
				}, function(data) {
					if(data.result){
						var origValue=$("#pupcount"+postId).text();
						if(operate==0){
							$("#pupcount" + postId).text(parseInt(origValue) + 1);
							$("#cpupcount" + postId).text(parseInt(origValue) + 1);
							$("#uppost"+postId).hide();
							$("#cuppost"+postId).show();
						}else{
							$("#cpupcount" + postId).text(parseInt(origValue) - 1);
							$("#pupcount" + postId).text(parseInt(origValue) - 1);
							$("#uppost"+postId).show();
							$("#cuppost"+postId).hide();
						}
					}else{
						alert("请先登录");
					}
				}, "json");
			}
			function apply(id, val,pid){
				$.post("${base}/member/applyJson.jhtml",{"u": val},function(data){
					$("#u"+id+"_"+pid).css("iconfont  icon-tongxunlu green");
				});
			}
			function applyDel(id, uid,pid){
				$.post("${base}/member/delJson.jhtml",{"uid": uid},function(data){
					if(data.status==-1){
						$("#u"+id+"_"+pid).css("iconfont  icon-tongxunlu1 green");
					}
				});
			}
			function report(url){
				$.post("${base}/member/report.jhtml",{"url": url},function(data){
					alert("举报成功!");
				}, "json");
			}
			function forBidden(userId,forumId){
				$.post("${base}/user/forbidden.jspx",{
					"userId": userId,
					"forumId":forumId
				},function(data){
					if(data.status==1){
						$("a[id^='forbiddenLink_"+userId+"']").each(function(){
							$(this).prop("title","禁用");
							$(this).html("禁用");
						});
					}else if(data.status==2){
						$("a[id^='forbiddenLink_"+userId+"']").each(function(){
							$(this).prop("title","解除禁用");
							$(this).html("解除禁用");
						});
					}else if(data.status==0){
						alert("禁用失败!");
					}
				},"json");
		    }
			//operate 0关注  1取消关注
			function attent(userId,operate){
				$.post("${base}/member/attent.jhtml",{
					"userId": userId
				},function(data){
					if(operate==1){
						$("a[id^='a"+userId+"']").each(function(i){
						   $(this).prop("class","iconfont icon-guanzhu yellow");
						});
					}else{
						$("a[id^='a"+userId+"']").each(function(i){
						  $(this).prop("class","iconfont icon-yiguanzhu yellow");
						});
					}
				},"json");
			}
			/**
			 * 主题互动 0点赞  2关注  3取消点赞  5取消关注 
			 */
			function topicOp(topicId, operate) {
				$.post("${base}/topic/operate.jspx", {
					"topicId" : topicId,
					"operate" : operate
				}, function(data) {
					if(data.result){
						if(operate==2){
							$("#attenttopic"+topicId).hide();
							$("#cattenttopic"+topicId).show();
						}else if(operate==5){
							$("#attenttopic"+topicId).show();
							$("#cattenttopic"+topicId).hide();
						}else if(operate==0){
							$("#uptopic"+topicId).hide();
							$("#cuptopic"+topicId).show();
							var origValue=$("#upcount"+topicId).html()
							$("#upcount"+topicId).html(parseInt(origValue) + 1);
							$("#cupcount"+topicId).html(parseInt(origValue) + 1);
						}else if(operate==3){
							$("#uptopic"+topicId).show();
							$("#cuptopic"+topicId).hide();
							var origValue=$("#upcount"+topicId).html()
							$("#upcount"+topicId).html(parseInt(origValue) - 1);
							("#cupcount"+topicId).html(parseInt(origValue) - 1);
						}
					}else{
						alert("请先登录");
					}
				}, "json");
			}
			function checkContent(){
			  if($("#_editor_textarea_more").val()==""){
				 alert("内容不能为空");
				 return false;
			  }
			  return true;
			}
			 function upTopLevel(topicId,forumId){
				$.post("${base}/topic/o_upTopAjax.jspx",{
					"topicId": topicId,
					"forumId":forumId
				},function(data){
					if(data.status==1){
						$("#topLevel"+topicId).prop("title","取消置顶");
						$("#topLevel"+topicId+" span").html("取消置顶");
					}else if(data.status==2){
						$("#topLevel"+topicId).prop("title","置顶");
						$("#topLevel"+topicId+" span").html("置顶");
					}
				},"json");
			 }
			function getPostChildInner(parentId,pageNo){
				if(pageNo==null){
					pageNo=1;
				}
				$("#postChildPage"+parentId,window.parent.document).load("${base}/post/listChild.jspx?orderBy=1&parentId="+parentId+"&pageNo="+pageNo);
			}
		</script>
	</body>

</html>