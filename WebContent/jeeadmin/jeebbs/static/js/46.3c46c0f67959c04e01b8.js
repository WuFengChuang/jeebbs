webpackJsonp([46],{1009:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"forum-module"},[a("div",{staticClass:"forum-header"},[a("span",{staticClass:"forum-name"},[t._v(t._s(t.$route.name))])]),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading.body",value:t.loading,expression:"loading",modifiers:{body:!0}}],staticClass:"table-body table-responsive"},[a("el-form",{ref:"topicInfo",attrs:{rules:t.rules,model:t.giftInfo}},[a("el-form-item",{staticClass:"form-group",attrs:{label:"名称",prop:"name"}},[a("el-col",{attrs:{span:6}},[a("el-input",{model:{value:t.giftInfo.name,callback:function(e){t.$set(t.giftInfo,"name",e)},expression:"giftInfo.name"}})],1),t._v(" "),a("el-col",{staticClass:"required",attrs:{span:1}},[t._v("\n                         *\n                    ")])],1),t._v(" "),a("el-form-item",{staticClass:"form-group",attrs:{label:"支付方式"}},[a("el-col",{attrs:{span:6}},[a("el-select",{model:{value:t.giftInfo.credit,callback:function(e){t.$set(t.giftInfo,"credit",e)},expression:"giftInfo.credit"}},t._l(t.options,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)],1),t._v(" "),a("el-form-item",{staticClass:"form-group",attrs:{label:"价格",prop:"price"}},[a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{type:"number"},model:{value:t.giftInfo.price,callback:function(e){t.$set(t.giftInfo,"price",t._n(e))},expression:"giftInfo.price"}})],1),t._v(" "),a("el-col",{staticClass:"required",attrs:{span:1}},[t._v("\n                         *\n                    ")])],1),t._v(" "),a("el-form-item",{staticClass:"form-group",attrs:{label:"道具存货量",prop:"num"}},[a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{type:"number"},model:{value:t.giftInfo.num,callback:function(e){t.$set(t.giftInfo,"num",t._n(e))},expression:"giftInfo.num"}})],1),t._v(" "),a("el-col",{staticClass:"required",attrs:{span:1}},[t._v("\n                         *\n                    ")])],1),t._v(" "),a("el-form-item",{staticClass:"form-group",attrs:{label:"道具描述",prop:"description"}},[a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.giftInfo.description,callback:function(e){t.$set(t.giftInfo,"description",t._n(e))},expression:"giftInfo.description"}})],1),t._v(" "),a("el-col",{staticClass:"required",attrs:{span:1}},[t._v("\n                         *\n                    ")])],1),t._v(" "),a("el-form-item",{staticClass:"form-group",attrs:{label:"道具图片"}},[a("el-col",{attrs:{span:6}},[a("el-input",{model:{value:t.giftInfo.magicLogo,callback:function(e){t.$set(t.giftInfo,"magicLogo",e)},expression:"giftInfo.magicLogo"}}),t._v(" "),a("div",{class:t.state?"pic-box":"pic-box-no"},[t.state?t._e():a("img",{attrs:{src:t.$store.state.baseUrl+t.imgPath,alt:""},on:{click:t.showBig}})])],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-upload",{staticClass:"upload-demo",attrs:{action:t.$store.state.upLoadUrl,name:"uploadFile",data:t.upobj,"before-upload":t.beforeAvatarUpload,"on-success":t.getImgpic,"show-file-list":t.fileState}},[a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"}},[t._v("点击上传")])],1),t._v(" "),a("el-dialog",{staticClass:"pic-dialog",attrs:{title:"按下esc退出全屏",size:"full"},model:{value:t.dialogVisible,callback:function(e){t.dialogVisible=e},expression:"dialogVisible"}},[a("img",{staticClass:"big-img",attrs:{src:t.$store.state.baseUrl+t.imgPath,alt:""}})])],1)],1),t._v(" "),a("el-form-item",{staticClass:"form-group",attrs:{label:"允许使用的用户组",prop:"priority"}},[a("el-col",{attrs:{span:10}},[a("el-checkbox",{attrs:{indeterminate:t.isIndeterminate},on:{change:t.handleCheckAllChange},model:{value:t.checkAll,callback:function(e){t.checkAll=e},expression:"checkAll"}},[t._v("全选")]),t._v(" "),a("el-checkbox-group",{on:{change:t.handleCheckedCitiesChange},model:{value:t.groupIds,callback:function(e){t.groupIds=e},expression:"groupIds"}},t._l(t.groupList,function(e){return a("el-checkbox",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.name))])}))],1)],1),t._v(" "),a("el-form-item",{staticClass:"form-group",attrs:{label:"允许被使用的用户组",prop:"priority"}},[a("el-col",{attrs:{span:10}},[a("el-checkbox",{attrs:{indeterminate:t.isIndeterminate2},on:{change:t.handleCheckAllChange2},model:{value:t.checkAll2,callback:function(e){t.checkAll2=e},expression:"checkAll2"}},[t._v("全选")]),t._v(" "),a("el-checkbox-group",{on:{change:t.handleCheckedCitiesChange2},model:{value:t.beUsedGroupIds,callback:function(e){t.beUsedGroupIds=e},expression:"beUsedGroupIds"}},t._l(t.groupList,function(e){return a("el-checkbox",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.name))])}))],1)],1)],1),t._v(" "),a("div",{staticClass:"margin-md"},["edit"==t.$route.query.type?a("input",{staticClass:"bbs-submit",attrs:{type:"button",value:"提交"},on:{click:function(e){t.updateGiftInfo("topicInfo")}}}):t._e(),t._v(" "),a("input",{staticClass:"bbs-reset",attrs:{type:"reset",value:"重置"}})])],1)])},staticRenderFns:[]}},609:function(t,e,a){function i(t){a(922)}var s=a(66)(a(703),a(1009),i,"data-v-ce988bc8",null);t.exports=s.exports},658:function(t,e,a){"use strict";function i(t){return a.i(L.a)({url:"/api/admin/group/list",method:"post",signValidate:!1,data:t})}function s(t){return a.i(L.a)({url:"/api/admin/group/delete",method:"post",signValidate:!0,data:t})}function n(t){return a.i(L.a)({url:"/api/admin/group/get",method:"post",signValidate:!1,data:t})}function o(t){return a.i(L.a)({url:"/api/admin/group/update",method:"post",signValidate:!0,data:t})}function r(t){return a.i(L.a)({url:"/api/admin/group/save",method:"post",signValidate:!0,data:t})}function l(t){return a.i(L.a)({url:"/api/admin/user/list",method:"post",signValidate:!1,data:t})}function u(t){return a.i(L.a)({url:"/api/admin/user/official_list",method:"post",signValidate:!1,data:t})}function d(t){return a.i(L.a)({url:"/api/admin/user/get",method:"post",signValidate:!1,data:t})}function c(t){return a.i(L.a)({url:"/api/admin/user/update",method:"post",signValidate:!0,data:t})}function p(t){return a.i(L.a)({url:"/api/admin/user/save",method:"post",signValidate:!0,data:t})}function g(t){return a.i(L.a)({url:"/api/admin/user/delete",method:"post",signValidate:!0,data:t})}function m(t){return a.i(L.a)({url:"/api/admin/admin/list",method:"post",signValidate:!1,data:t})}function f(t){return a.i(L.a)({url:"/api/admin/admin/update",method:"post",signValidate:!0,data:t})}function h(t){return a.i(L.a)({url:"/api/admin/admin/save",method:"post",signValidate:!0,data:t})}function b(t){return a.i(L.a)({url:"/api/admin/role/list",method:"post",signValidate:!1,data:t})}function v(t){return a.i(L.a)({url:"/api/admin/role/delete",method:"post",signValidate:!0,data:t})}function I(t){return a.i(L.a)({url:"/api/admin/role/get",method:"post",signValidate:!1,data:t})}function k(t){return a.i(L.a)({url:"/api/admin/role/update",method:"post",signValidate:!0,data:t})}function y(t){return a.i(L.a)({url:"/api/admin/role/save",method:"post",signValidate:!0,data:t})}function _(t){return a.i(L.a)({url:"/api/admin/account/list",method:"post",signValidate:!0,data:t})}function C(t){return a.i(L.a)({url:"/api/admin/account/delete",method:"post",signValidate:!0,data:t})}function x(t){return a.i(L.a)({url:"/api/admin/message/sys_list",method:"post",signValidate:!0,data:t})}function V(t){return a.i(L.a)({url:"/api/admin/message/delete",method:"post",signValidate:!0,data:t})}function $(t){return a.i(L.a)({url:"/api/admin/message/sendSys",method:"post",signValidate:!0,data:t})}e.a=i,e.x=s,e.u=n,e.v=o,e.w=r,e.t=l,e.o=u,e.l=d,e.m=c,e.n=p,e.p=g,e.s=m,e.q=f,e.r=h,e.j=b,e.k=v,e.g=I,e.h=k,e.i=y,e.e=_,e.f=C,e.c=x,e.d=V,e.b=$;var L=a(150),A=a(101);a.n(A)},703:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a(228),s=a(658);e.default={data:function(){return{fileState:!0,dialogVisible:!1,checkAll:!0,isIndeterminate:!0,checkAll2:!0,isIndeterminate2:!0,loading:!0,state:!1,imgPath:"",upobj:{type:"image",sessionKey:localStorage.getItem("sessionKey"),appId:this.$store.state.appId},giftInfo:{},groupList:[],groupListIds:[],beUsedGroupIds:[],groupIds:[],rules:{name:[{required:!0,message:"请填写一个名字",trigger:"blur"}],num:[{required:!0,type:"number",message:"请填写一个数字",trigger:"blur"}],price:[{required:!0,type:"number",message:"请填写一个价格",trigger:"blur"}],description:[{required:!0,message:"请填写一个描述",trigger:"blur"}]},options:[{value:1,label:"积分"},{value:2,label:"威望"},{value:3,label:"人民币"}]}},methods:{showBig:function(){this.dialogVisible=!0},handleCheckAllChange:function(t){this.groupIds=t.target.checked?this.groupListIds:[],this.isIndeterminate=!1},handleCheckedCitiesChange:function(t){var e=t.length;this.checkAll=e===this.groupListIds.length,this.isIndeterminate=e>0&&e<this.groupListIds.length},handleCheckAllChange2:function(t){this.beUsedGroupIds=t.target.checked?this.groupListIds:[],this.isIndeterminate2=!1},handleCheckedCitiesChange2:function(t){var e=t.length;this.checkAll2=e===this.groupListIds.length,this.isIndeterminate2=e>0&&e<this.groupListIds.length},getuserGroupList:function(){var t=this;s.a({groupType:-1}).then(function(e){t.groupList=e.body;for(var a=0;a<e.body.length;a++)t.groupListIds.push(e.body[a].id)})},getMagicInfo:function(t){var e=this;i.w({id:t}).then(function(t){"100"==t.code?(e.loading=!1,e.giftInfo=t.body,e.beUsedGroupIds=e.changeInt(t.body.beUsedGroupIds),e.groupIds=e.changeInt(t.body.groupIds),""==e.giftInfo.magicLogo?e.state=!0:(e.imgPath=t.body.magicLogo,e.state=!1)):(e.loading=!1,e.$message.error(t.message))}).catch(function(t){e.loading=!1,e.$message.error("网络异常")})},changeInt:function(t){var e=t.split(","),a=[];if(null==t||""==t)a=[];else for(var i=0;i<e.length;i++)a.push(parseInt(e[i]));return a},updateGiftInfo:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;var a=e.giftInfo;a.groupIds=e.groupIds.join(","),a.beUsedGroupIds=e.beUsedGroupIds.join(","),i.x(a).then(function(t){"100"==t.code?(e.$message.success("修改成功"),setTimeout(function(){e.$router.push({path:"/magiclist"})},1e3)):e.$message.error(t.message)}).catch(function(t){e.$message.error("修改失败")})})},back:function(){this.$router.push({path:"/magiclist",query:{noceStr:Math.round(10*Math.random())}})},beforeAvatarUpload:function(t){this.fileState=!0;var e="image/jpeg"===t.type||"image/png"===t.type||"image/gif"===t.type,a=t.size/1024/1024<2;return e||this.$message.error("上传头像图片只能是 JPG 格式!"),a||this.$message.error("上传头像图片大小不能超过2MB!"),e&&a},getImgpic:function(t,e,a){this.imgPath=t.body.url,this.state=!1,this.fileState=!1,this.giftInfo.magicLogo=t.body.url},resetForm:function(t){this.$route.query.id;this.$refs[t].resetFields()}},created:function(){var t=this.$route.query.type,e=this.$route.query.id;"add"==t?(this.getuserGroupList(),this.getMagicInfo(e)):"edit"==t&&(this.getuserGroupList(),this.getMagicInfo(e))},watch:{$route:function(t,e){var a=this.$route.query.id;this.loading=!0,this.getuserGroupList(),this.getMagicInfo(a)}}}},836:function(t,e,a){e=t.exports=a(570)(!1),e.push([t.i,".el-checkbox-group>label[data-v-ce988bc8]{display:inline-block}",""])},922:function(t,e,a){var i=a(836);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a(571)("bb041336",i,!0)}});